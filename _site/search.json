[
  {
    "objectID": "volant.html",
    "href": "volant.html",
    "title": "volant",
    "section": "",
    "text": "Les expressions régulières sont communément appelées regex ou regexp pour regular expressions en anglais. Selon Wikipédia, une expression régulière est “une chaîne de caractères, qui décrit, selon une syntaxe précise, un ensemble de chaînes de caractères possibles”. Si vous n’avez jamais entendu parlé des regex, il se peut que cette définition ne vous aide pas à comprendre le concept. Nous tenterons de démystifier le tout au cours de ces exercices.\nÀ titre de rappel, cet aide-mémoire vous sera drôlement utile!\nEn résumé, ces expressions permettent de décrire des motifs (patterns) à l’aide de formules “relativement simples” pour trouver, valider, extraire ou modifier du texte ou des nombres."
  },
  {
    "objectID": "volant.html#mission-daujourdhui",
    "href": "volant.html#mission-daujourdhui",
    "title": "volant",
    "section": "Mission d’aujourd’hui:",
    "text": "Mission d’aujourd’hui:\nRécolter le plus d’information possible qui se trouve dans les tableaux de la page suivante: https://tc.canada.ca/fr/aviation/exploitation-aeroports-aerodromes/liste-aeroports-appartenant-transports-canada.\n\nlibrary(tidyverse)\n\nWarning: le package 'tidyverse' a été compilé avec la version R 4.1.3\n\n\n-- Attaching packages --------------------------------------- tidyverse 1.3.2 --\nv ggplot2 3.3.6     v purrr   0.3.4\nv tibble  3.1.6     v dplyr   1.0.8\nv tidyr   1.2.0     v stringr 1.4.1\nv readr   2.1.2     v forcats 0.5.1\n\n\nWarning: le package 'ggplot2' a été compilé avec la version R 4.1.3\n\n\nWarning: le package 'tidyr' a été compilé avec la version R 4.1.3\n\n\nWarning: le package 'readr' a été compilé avec la version R 4.1.3\n\n\nWarning: le package 'dplyr' a été compilé avec la version R 4.1.3\n\n\nWarning: le package 'stringr' a été compilé avec la version R 4.1.3\n\n\n-- Conflicts ------------------------------------------ tidyverse_conflicts() --\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\n\nlibrary(magrittr)\n\nWarning: le package 'magrittr' a été compilé avec la version R 4.1.3\n\n\n\nAttachement du package : 'magrittr'\n\nL'objet suivant est masqué depuis 'package:purrr':\n\n    set_names\n\nL'objet suivant est masqué depuis 'package:tidyr':\n\n    extract\n\nlibrary(rvest)\n\nWarning: le package 'rvest' a été compilé avec la version R 4.1.3\n\n\n\nAttachement du package : 'rvest'\n\nL'objet suivant est masqué depuis 'package:readr':\n\n    guess_encoding\n\n\n\nURL <- \"https://tc.canada.ca/fr/aviation/exploitation-aeroports-aerodromes/liste-aeroports-appartenant-transports-canada\"\n\n\nDébut de solution en base R\n\nbase_raw_html <- read_html(x = URL)\nbase_html_table <- html_elements(x = base_raw_html, css = \"table\")\nbase_tables <- html_table(x = base_html_table)\n\n# base_table <- rbind(base_tables[[1]], base_tables[[2]], base_tables[[3]])\n\n\nnames(base_tables[[3]])\n\n[1] \"Territoire\"   \"Aéroport\"     \"Exploité par\"\n\n\n⚠️ Erreur! Une colonne n’est pas nommée de façon identique, donc ne fonctionne pas… Corrigeons la situation\n\nnames(base_tables[[3]])[1] <- \"Province/Territoire\"\n\nbase_table <- rbind(base_tables[[1]], base_tables[[2]], base_tables[[3]])\n\nbase_table\n\n# A tibble: 44 x 3\n   `Province/Territoire`  Aéroport                `Exploité par`                \n   <chr>                  <chr>                   <chr>                         \n 1 \"Colombie-Britannique\" Penticton               \"Transports Canada\\n\\t\\t\\t#10~\n 2 \"\"                     Port Hardy              \"Transports Canada\\n\\t\\t\\tC.P~\n 3 \"\"                     Sandspit                \"Transports Canada\\n\\t\\t\\tC.P~\n 4 \"\"                     Havre de Victoria       \"Transports Canada\\n\\t\\t\\t12,~\n 5 \"Manitoba\"             Churchill               \"Transports Canada\\n\\t\\t\\tC.P~\n 6 \"Québec\"               Chevery                 \"Municipalité de la Côte-Nord~\n 7 \"\"                     Lourdes-de-Blanc-Sablon \"Transports Canada\\n\\t\\t\\tAir~\n 8 \"\"                     Sept-Îles               \"Transports Canada\\n\\t\\t\\t100~\n 9 \"\"                     Natashquan              \"Municipalité de Natashquan\\n~\n10 \"\"                     Eastmain River          \"Transports Canada\\n\\t\\t\\ta/s~\n# ... with 34 more rows\n\n# Solution en Base R\nbase_table$`Province/Territoire` <- ifelse(test = is.na(base_table$`Province/Territoire`),\n                                  yes = base_table$Territoire, no = base_table$`Province/Territoire`)\nbase_table$Territoire <- NULL\n\nrm(list=(ls(pattern = \"base*\")))"
  },
  {
    "objectID": "volant.html#solution-à-la-tidyverse",
    "href": "volant.html#solution-à-la-tidyverse",
    "title": "volant",
    "section": "Solution à la Tidyverse",
    "text": "Solution à la Tidyverse\n\nURL <- \"https://tc.canada.ca/fr/aviation/exploitation-aeroports-aerodromes/liste-aeroports-appartenant-transports-canada\"\n\n\ntables <- read_html(x = URL) %>%\n    html_elements(css = \"table\") %>%\n    html_table()\n\ntable <- dplyr::bind_rows(tables[[1]],\n                          tables[[2]],\n                          tables[[3]],\n                          .id = \"type\")\n\n# ou solution alternative équivalente\ntables %>% purrr::map_dfr(bind_rows, .id = \"type\")\n\n# A tibble: 44 x 5\n   type  `Province/Territoire`  Aéroport               `Exploité par` Territoire\n   <chr> <chr>                  <chr>                  <chr>          <chr>     \n 1 1     \"Colombie-Britannique\" Penticton              \"Transports C~ <NA>      \n 2 1     \"\"                     Port Hardy             \"Transports C~ <NA>      \n 3 1     \"\"                     Sandspit               \"Transports C~ <NA>      \n 4 1     \"\"                     Havre de Victoria      \"Transports C~ <NA>      \n 5 1     \"Manitoba\"             Churchill              \"Transports C~ <NA>      \n 6 1     \"Québec\"               Chevery                \"Municipalité~ <NA>      \n 7 1     \"\"                     Lourdes-de-Blanc-Sabl~ \"Transports C~ <NA>      \n 8 1     \"\"                     Sept-Îles              \"Transports C~ <NA>      \n 9 1     \"\"                     Natashquan             \"Municipalité~ <NA>      \n10 1     \"\"                     Eastmain River         \"Transports C~ <NA>      \n# ... with 34 more rows\n\n\n\nRemplir les rangées de la colonne Province/Territoire\n\ntable <- table %>% dplyr::rename(province_territoire = `Province/Territoire`,\n                        aeroport = Aéroport,\n                        exploited_by = `Exploité par`,\n                        territoire = Territoire)\n\ntable$province_territoire <- dplyr::coalesce(table$province_territoire, \n                                              table$territoire)\n\n\n\ntable[table == \"\"] <- NA\n# equivalent en tidyverse\ntable$province_territoire <- table$province_territoire %>% dplyr::na_if(y = \"\")\ntable <- table %>% tidyr::fill(province_territoire, .direction = \"down\")\n\n\ntable <- table %>% dplyr::select(-territoire)\n\nExtraction des codes d’aéroports\n\n# solution #1\nx <- table %>% mutate(new_col = str_extract(string = aeroport, pattern = \"[A-Z]{3}\"))\n\ntable <- table %>% tidyr::extract(col = aeroport,\n                         into = \"code_aeroport\",\n                         regex = \"(Y[A-Z][A-Z])\", \n                         remove = FALSE)\n\ntable$aeroport <- table$aeroport %>%\n    stringr::str_remove_all(pattern = \"\\\\(.*\\\\)\") %>%\n    stringr::str_squish()"
  },
  {
    "objectID": "volant.html#recodage-des-types-daéroport",
    "href": "volant.html#recodage-des-types-daéroport",
    "title": "volant",
    "section": "Recodage des types d’aéroport",
    "text": "Recodage des types d’aéroport\n\nx <- table %>% mutate(type_nouveau = recode(type,\n                                            \"1\" = \"Petits aéroports\",\n                                            \"2\" = \"Aéroports nationaux\", \n                                            \"3\" = \"Aéroports nationaux exploités par des administrations territoriales\"))\n\nx <- x %>% mutate(type_nouveau_case = case_when(type == 1 ~ \"Petits aéroports\", \n                                               type == 2 ~ \"Aéroports nationaux\",\n                                               type == 3 ~ \"Aéroports nationaux exploités par des administrations territoriales\"))"
  },
  {
    "objectID": "volant.html#il-ne-reste-plus-quà-extraire-linformation-qui-se-trouve-dans-tableexploited_by",
    "href": "volant.html#il-ne-reste-plus-quà-extraire-linformation-qui-se-trouve-dans-tableexploited_by",
    "title": "volant",
    "section": "Il ne reste plus qu’à extraire l’information qui se trouve dans table$exploited_by",
    "text": "Il ne reste plus qu’à extraire l’information qui se trouve dans table$exploited_by\n\ncat(table$exploited_by) \n\nTransports Canada\n            #109-3000 Airport Road\n            Penticton (Colombie-Britannique)  V2A 8X1\n            250-770-4414 Transports Canada\n            C.P. 460\n            3675 Byng Road\n            Port Hardy (Colombie-Britannique)  V0N 2P0\n            250-949-6424 Transports Canada\n            C.P. 439\n            Sandspit (Colombie-Britannique)  V0T 1T0\n            250-637-1149 Transports Canada\n            12, rue Erie\n            Victoria (Colombie-Britannique)  V8V 1Y4\n            250-363-3578 Transports Canada\n            C.P. 1059\n            Churchill (Manitoba)  R0B 0E0\n            204-675-8868 Municipalité de la Côte-Nord-du Golfe-du Saint-Laurent\n            Chevery (Québec)  G0G 1G0\n            418-787-2215 Transports Canada\n            Airport Road\n            Lourdes-de-Blanc-Sablon (Québec)  G0G 1W0\n            418-461-2514 Transports Canada\n            1000, boul. Laure Est\n            C.P. 2001\n            Sept-Îles (Québec)  G4R 4K2\n            418-962-8211 Municipalité de Natashquan\n            Airport Road\n            Natashquan (Québec)  G0G 2E0\n            418-726-3273 Transports Canada\n            a/s du conseil de bande\n            Eastmain (Québec)  J0M 1W0\n            819-977-0333 Transports Canada\n            1550 B, route de l'Aéroport\n            Havre-Saint-Pierre (Québec)\n            G0G 1P0\n            418-538-0627 Transports Canada\n            1-210, chemin de l’Aéroport\n            Havre-aux-Maisons (Québec)\n            G4T 5L2\n            418-969-2180 Transports Canada\n            a/s du conseil de bande\n            Waskaganish (Québec)  J0M 1R0\n            819-895-8925 Administration régionale Kativik\n            C.P. 9\n            Kuujjuaq (Québec)  J0M 1C0\n            819-964-2968 Société aéroportuaire de Schefferville\n            78 Atlantic Road\n            Schefferville (Québec)  G0G 2T0\n            418-585-3544 Transports Canada\n            a/s du conseil de bande\n            Wemindji (Québec)  J0M 1L0\n            819-978-3936 Transports Canada\n            2 Airport Road\n            Wabush (Terre-Neuve)  A0R 1B0\n            709-282-5412 Transports Canada\n            1 Airport Road\n            St. Anthony (Terre-Neuve)  A0K 4S0\n            709-454-3192 Administration aéroportuaire de Victoria Administration de l’aéroport international de Vancouver Administration aéroportuaire de Prince George Inc. (en anglais seulement) Ville de Kelowna (en anglais seulement) Administration des aéroports régionaux d’Edmonton (en anglais seulement) Administration aéroportuaire de Calgary (en anglais seulement) Administration aéroportuaire de Saskatoon (en anglais seulement) Administration aéroportuaire de Regina Administration aéroportuaire de Winnipeg Inc. Administration de l’aéroport international de Thunder Bay Inc. (en anglais seulement) Administration de l’aéroport international du Grand London (en anglais seulement) Autorité aéroportuaire du Grand Toronto Administration de l’aéroport international Macdonald-Cartier d'Ottawa Aéroports de Montréal Aéroports de Montréal Aéroport de Québec Inc. Administration de l’aéroport international de Fredericton Administration de l’aéroport international du Grand Moncton Inc. Aéroport de Saint John Inc. Administration de l’aéroport de Charlottetown Inc. (en anglais seulement) Administration de l’aéroport international de Halifax Administration de l’aéroport international de Gander Inc. (en anglais seulement) Administration de l’aéroport international de St. John’s Gouvernement des Territoires du Nord-Ouest Gouvernement du Nunavut Gouvernement du Yukon"
  }
]